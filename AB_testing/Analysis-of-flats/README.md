## Исследование рынка квартир
Датасет содержит информацию о публикациях объявлений квартир, основные поля: количество изображений в объявлении, расстояние до парка/водоема/аэропорта, количество комнат, этаж, общая и жилая площадь, свободная планировка, количество балконов и так далее.

Всего 22 столбца и 23699 записи
<br><br>

**Цели:**
- Провести исследовательский анализ данных: оценить наличие и качество данных, оценить распределение данных
- Очистить данные от выбросов и удалить лишние стобцы
- Выявить закономерности в данных, выдвинуть гипотезы и проверить их с помощью статистических критериев
<br><br>

**Инструменты:**
- Библиотеки для обработки данных, визуализации и для проверки гипотез: pandas, numpy, matplotlib, seaborn, scipy.stats
- Статистические критерии: тест Манна-Уитни, однофакторная ANOVA, пост-хок тест Тьюки, тест Бартлетта, бутстрепный доверительный интервал, корреляционный анализ Пирсона
<br><br>

**Выводы и результаты:**
1) В ходе ознакомления с данными удалось узнать, что
   - Данные собраны для квартир в Санкт-Петербурге (67% данных) и в Ленинградской области (33% данных)
   - Данные представлены за период: с 2014-11-27 по 2019-05-03
   - Практически нет апартаментов и квартир со свободной планировкой
   - Дубликаты в данных отсутствуют
   - Количество фотографий на объявлениях почти всегда меньше 20, вероятно это ограничение со стороны сервиса
   - В мае и июне покупают меньше всего квартир, пик продаж приходится на апрель
2) После ознакомления обработал данные:
   - Два столбца имели слишком много пропусков и не несли полезной информации для анализа, их удалил
   - Заполнил пропуски в столбце ceiling_height с помощью медианного значения
   - Удалил выбросы и записи с некорректными значениями (например, отрицательная цена или 0 комнат). Смотрел выбросы по цене и расстоянию до центра города. Итого удалил 3,54% от изначального количество записей
   - Добавил столбец type_locality, показывающий находится ли квартир в городе или за городом, добавил столбец с датой удаления снятия публикации
   - Построил несколько графиков, для того, чтобы лучше понять как устроены данные
3) Провел корреляционный анализ:
   - Количество комнат коррелирует с общей площадью и жилой площадью (коэффициенты корреляции Пирсона 0,79 и 0,87 соответственно)
   - Цена на момент снятия с публикации коррелирует с жилой площадью (коэффициент корреляции Пирсона 0,7)
   - В ходе корреляционного анализа не удалось выявить нетривиальные и статистически значимые взаимосвязи между признаками
4) Выдвинул продуктовые гипотезы и протестировал их с помощью подходящих статистических критериев (подробнее ниже):
<br><br>

**Гипотезы и их проверка:**
1) *Среднее время продажи различается для одно/двух/трехкомнатных квартир*

Размер выборок: 4000-5500 наблюдений для каждой группы

   Это множественное тестирование (3 группы), чтобы определиться с выбором теста оценил распределение данных. Оно оказалось сильно скошено вправо, то есть далеко от нормального. Для борьбы с этим я прологарифмировал данные, теперь распределение стало намного больше напоминать нормальное.

   Далее я провел **тест Бартлетта** для проверки гипотезы о гомогенности дисперсий в группах, он не отвергнул нулевую гипотезу. Так как данные нормальны и дисперсии равны, то я решил использовать **однофакторную ANOVA**, она показала различия между группами. После прокраски ANOVA я использовал пост-хок **тест Тьюки** (он применим по тем же причинам) для попарного сравнения групп. Он показал различия для каждой пары. Уровень значимости во всех тестах установил на уровне 5%.

   Вывод: среднее время продажи однокомнатной квартиры > среднее время продажи двухкомнатной квартиры > среднее время продажи трехкомнатной квартиры.
   <br><br>

2) *Среднее время продажи квартир в городе больше, чем у квартир за городом*

Размер выборок: 3300 в одной группе и 16500 в другой
   
   Первый взгляд на средние значения в каждой из двух групп навел на эту гипотезу. Визуальная оценка распределения показала сильную скошенность вправо. Поэтому вместо классического Т-теста решил использовать непараметрический **критерий Манна Уитни** из-за его устойчивость к выбросам и нарушению нормальности.

   В результате проведенного теста не смог отвергнуть нулевую гипотезу о равенстве средних в двух группах на 5% уровне значимости

   Вывод: нельзя утверждать, что время продажи квартир в городе больше, чем у квартир за городом.
<br><br>

3) *Средняя цена квартир в Санкт-Петербурге с большим количеством фотографий в объявлении выше, чем у квартир с меньшим количеством объявлений*

Размер выборок: 4300 в каждой группе

Считал, что 14+ фотографий это много (75% квантиль), а 6- фотографий это мало (25% квантиль).

   Эффект был сильно заметен и без проведения тестирования (вероятно это связано с тем. что продавец, желающий продать квартиру подороже, обычно готов потратить больше времени на создание привлекательного объявления). Но для подтверждения гипотезы был снова выбран **критерий Манна Уитни**, так как распределение данных было далеко от нормального. Нулевая гипотеза была отвергнута на 5% уровне значимости.

   Для того, чтобы оценить величину эффекта: насколько цена выше, я построил 95% доверительный интервал **методом бутстрепа**. Из-за специфичности рассматриваемого параметра и ненормальности данных классические методы построения доверительных интервалов были неприменимы. 

   Вывод: цена на квартиру в Санкт-Петербурге с большим количеством фотографий (не менее 14) в публикации в среднем выше цены квартиры с небольшим количеством фотографии (не более 6) в объявлении, размер эффекта колеблется в пределах 15-23%.
<br><br>

Примеры графиков:

![image](https://github.com/user-attachments/assets/26ccbd6b-eb5e-4e47-a924-6cf77b01a58d)
![image](https://github.com/user-attachments/assets/9704e7db-8707-43a6-a29d-2a667c1e20fd)
![image](https://github.com/user-attachments/assets/5c28cafc-fbdb-48b2-bcf7-b6d068208f81)

